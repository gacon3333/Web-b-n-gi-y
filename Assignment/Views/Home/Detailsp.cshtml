@model ClassLibrary1.Models.ChiTietSp

@{
    ViewData["Title"] = "Detailsp";
}
@{
    var session = Context.Request.HttpContext.Session;
}

<br />
<br />
<br />
<br />
@*<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
*@<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<style>
    .section {
        width: 100%;
        margin-left: -15px;
        padding: 2px;
        padding-left: 15px;
        padding-right: 15px;
        background: #f8f9f9
    }



    div.section > div {
        width: 100%;
        display: inline-flex;
    }

        div.section > div > input {
            margin: 0;
            padding-left: 5px;
            font-size: 10px;
            padding-right: 5px;
            max-width: 18%;
            text-align: center;
        }

    media (max-width: 426px) {
        .section

    {
        width: 104%;
    }

    }
</style>

<div class="container" style="max-height:500px;max-width:800px">
    <div class="card">
        <div class="container-fliud">
            <div class="wrapper row">
                <div class="preview col-md-6">
                    <div class="preview-pic tab-content">
                        <div class="tab-pane active" id="pic-1"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></div>
                        <div class="tab-pane" id="pic-2"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></div>
                        <div class="tab-pane" id="pic-3"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></div>
                        <div class="tab-pane" id="pic-4"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></div>
                        <div class="tab-pane" id="pic-5"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></div>
                    </div>
                    <ul class="preview-thumbnail nav nav-tabs">
                        <li class="active"><a data-target="#pic-1" data-toggle="tab"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></a></li>
                        <li><a data-target="#pic-2" data-toggle="tab"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></a></li>
                        <li><a data-target="#pic-3" data-toggle="tab"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></a></li>
                        <li><a data-target="#pic-4" data-toggle="tab"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></a></li>
                        <li><a data-target="#pic-5" data-toggle="tab"><img src="@Html.DisplayFor(model => model.LinkAnh)" /></a></li>
                    </ul>
                </div>
                <div class="details col-md-6">
                    <h3 class="product-title">@Html.DisplayFor(model => model.Ten)</h3>
                    <div class="rating">
                        <div class="stars">
                            <span class="fa fa-star checked"></span>
                            <span class="fa fa-star checked"></span>
                            <span class="fa fa-star checked"></span>
                            <span class="fa fa-star"></span>
                            <span class="fa fa-star"></span>
                        </div>
                        <span class="review-no">41 reviews</span>
                    </div>
                    <p class="product-description"> @Html.DisplayFor(model => model.MoTa)</p>
                    <h4 class="price">current price: <span>$@Html.DisplayFor(model => model.GiaBan)</span></h4>
                    <p class="vote"><strong>91%</strong> of buyers enjoyed this product! <strong>(87 votes)</strong></p>
                    <h5 class="sizes">
                        sizes:
                        <span class="size" data-toggle="tooltip" title="small"> @Html.DisplayFor(model => model.IdKichCoNavigation.Size)</span>
                        @*<span class="size" data-toggle="tooltip" title="medium">m</span>
                        <span class="size" data-toggle="tooltip" title="large">l</span>
                        <span class="size" data-toggle="tooltip" title="xtra large">xl</span>*@
                    </h5>
                    <h5 class="sizes">
                        Số lượng tồn:
                        <span class="size" data-toggle="tooltip" @*data-soluongton="@Model.SoLuongTon"*@ title="small"> @Html.DisplayFor(model => model.SoLuongTon)</span>
                    </h5>
                    <h5 class="sizes">
                        colors:
                        <span class="size" data-toggle="tooltip" title="small"> @Html.DisplayFor(model => model.IdMauSacNavigation.Ten)</span>
                    </h5>
                    <h5 class="sizes">
                        Bảo hành:
                        <span class="size" data-toggle="tooltip" title="small"> @Html.DisplayFor(model => model.BaoHanh)</span>
                    </h5>
                    @*<h5 class="colors">
                    colors:
                    <span class="color orange not-available" data-toggle="tooltip" title="Not In store"></span>
                    <span class="color green"></span>
                    <span class="color blue"></span>
                    </h5>*@
                    <div class="section" style="padding-bottom:20px;">
                        <br />
                        <div class="d-flex flex-row">
                            <p style="height:10px">Số lượng</p>
                            <button class="btn btn-link px-2"
                                    onclick="this.parentNode.querySelector('input[type=number]').stepDown()">
                                <i class="fas fa-minus"></i>
                            </button>

                            <input id="form1" min="1" max="@Model.SoLuongTon" @*oninput="validity.valid||(value='');"*@pattern="[0-9]+" step="1" name="quantity" value="1" type="number"
                                   class="form-control form-control-sm" style="width: 50px;" @*data-soluongton="@Model.SoLuongTon"*@ oninput="limitQuantity()" onblur="checkInput()" />

                            <button class="btn btn-link px-2"
                                    onclick="this.parentNode.querySelector('input[type=number]').stepUp()">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>

                    </div>
                    <br />
                    <div class="action">
                       @* @if (session.GetString("User") == null)
                        {
                            <button class="add-to-cart btn btn-default" type="button"><a asp-area="" asp-controller="Home" asp-action="Login">Login</a></button>
                        }
                        else
                        {*@
                            <button class="add-to-cart btn btn-default" type="button" onclick="addToCart('@Url.Action("AddToCarts", new { id = Model.Id })')">add to cart</button>

                       @* }*@
                        <button class="like btn btn-default" type="button"><span class="fa fa-heart"></span></button>
                    </div>
                    @*
                    <a href="@Url.Action("AddToCarts", new { id = Model.Id })">
                    <button class="add-to-cart btn btn-default" type="button">add to cart</button>
                    </a>
                    <button class="like btn btn-default" type="button"><span class="fa fa-heart"></span></button>
                    </div>*@
                    <div id="quantity-error" style="display: none; color: red;">Số lượng bạn chọn đã đạt mức tối đa của sản phẩm này</div>
                    <div id="quantity-error1" style="display: none; color: red;">Số lượng bạn nhập định dạng không đúng</div>
                </div>
            </div>
        </div>
    </div>
</div>

<br />
<br />
<br />
<br />
<br />
<br />
<script>
    function addToCart(url) {
        // Lấy giá trị số lượng từ input
        var quantity = document.getElementById("form1").value;
        // Lấy giá trị số lượng tồn từ data của thẻ input
        //var soluongton = document.getElementById("form1").getAttribute("data-soluongton");
        //// Nếu số lượng vượt quá số lượng tồn, hiển thị thông báo và không thực hiện chuyển hướng
        //if (quantity > soluongton) {
        //    alert("Số lượng bạn chọn đã vượt mức tối đa của sản phẩm này");
        //    return;
        //}
        // Thêm giá trị số lượng vào url action
        url = url + "?quantity=" + quantity;

        // Chuyển hướng đến action AddToCarts với tham số id và quantity
        window.location.href = url;
    }
    function limitQuantity() {
        var quantityInput = document.getElementById("form1");
        var quantityError = document.getElementById("quantity-error");
        var maxQuantity = @Model.SoLuongTon;
        if (quantityInput.value > maxQuantity) {
            quantityInput.value = maxQuantity;
            quantityError.style.display = "block";
        } else {
            if (quantityInput.value < 1) {
                quantityInput.value = Math.abs(quantityInput.value)
                quantityError1.style.display = "block";
            }
            else
                quantityError.style.display = "none";
        }


    }

    function increment() {
        var quantityInput = document.getElementById("form1");
        var maxQuantity = @Model.SoLuongTon;
        if (quantityInput.value < maxQuantity) {
            quantityInput.value++;
            limitQuantity();
        }
    }

    function decrement() {
        var quantityInput = document.getElementById("form1");
        if (quantityInput.value > 1) {
            quantityInput.value--;
            limitQuantity();
        }
    }
        //function checkInput() {
        //    var input = document.getElementById("form1");
        //    if (input.value < 0) {
        //        input.value = Math.abs(input.value); // Chuyển giá trị nhập vào thành số dương
        //    }
        //}
</script>